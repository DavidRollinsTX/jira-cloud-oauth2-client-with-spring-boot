<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="Destan Sarpkaya">
<title>Jira Cloud OAuth2 Client with Spring Boot</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<link rel="stylesheet" href="https://docs.spring.io/spring/docs/5.0.x/spring-framework-reference/stylesheets/asciidoctor-spring.css" />

<style>
    /*The same style with #header, #content, #footnotes, #footer which is located in asciidoctor-spring.css*/
    #comments {
        width: 100%;
        margin-left: auto;
        margin-right: auto;
        margin-top: 0;
        margin-bottom: 0;
        max-width: 62.5em;
        *zoom: 1;
        position: relative;
        padding-left: 0.9375em;
        padding-right: 0.9375em;
    }

    #toc {
        display: flex;
        flex-direction: column;
    }

    #scmUrlLeft{
        margin-top: auto;
        text-align: center;
    }

    #footer {
        margin-top: 10vh;
    }

    #footer-text a {
        color: white;
        text-decoration: none;
        line-height: inherit;
    }

    #footer-text a:hover,a:focus {
        text-decoration: underline;
    }

    img {
        border: 1px solid gainsboro;
    }
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Jira Cloud OAuth2 Client with Spring Boot</h1>
<div class="details">
<span id="author" class="author">Destan Sarpkaya</span><br>
<span id="revdate">2019-09-17</span>
<br><span id="revremark">Kod Gemisi</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_getting_started">Getting started</a>
<ul class="sectlevel2">
<li><a href="#_create_a_jira_cloud_account">Create a Jira Cloud account</a></li>
<li><a href="#_install_ngrok">Install ngrok</a></li>
<li><a href="#_create_an_atlassian_application">Create an Atlassian application</a>
<ul class="sectlevel3">
<li><a href="#_add_your_callback_url">Add your callback URL</a></li>
<li><a href="#_add_jira_api">Add Jira API</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_creating_the_client_application">Creating the client application</a>
<ul class="sectlevel2">
<li><a href="#_validating_our_setup">Validating our setup</a></li>
<li><a href="#_create_a_spring_boot_project">Create a Spring Boot project</a>
<ul class="sectlevel3">
<li><a href="#_dependencies">Dependencies</a></li>
<li><a href="#_configuration">Configuration</a></li>
<li><a href="#_how_will_it_work">How will it work?</a></li>
<li><a href="#_handling_the_callback">Handling the <code>/callback</code></a></li>
<li><a href="#_keeping_the_original_url">Keeping the original URL</a></li>
<li><a href="#_putting_all_together">Putting all together</a></li>
<li><a href="#_using_the_application">Using the application</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_troubleshooting">Troubleshooting</a>
<ul class="sectlevel2">
<li><a href="#_callback_url_is_not_whitelisted">Callback URL is not whitelisted</a></li>
<li><a href="#_failed_to_complete_tunnel_connection">Failed to complete tunnel connection</a></li>
</ul>
</li>
<li><a href="#_references">References</a>
<ul class="sectlevel2">
<li><a href="#_more_readings">More readings</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are currently 2 ways to consume Jira Cloud APIs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.atlassian.com/cloud/jira/platform/getting-started/">Connect apps</a></p>
</li>
<li>
<p>Other apps</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this tutorial or ultimate guide, we will be implementing a Spring Boot OAuth2 client application for <strong>other apps</strong> category.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
There is a Maven archetype to create boiler plate code for creating a <strong>connect app</strong>:
<a href="https://bitbucket.org/atlassian/atlassian-connect-spring-boot/src/master/">Atlassian Connect for Spring Boot</a>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Final result</div>
<div class="paragraph">
<p>As the final result we will be calling our application&#8217;s endpoint to call Jira Cloud REST API via Spring Security OAuth2 Client integration.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/homePage.png" alt="homePage">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/oauthAuthorizationPrompt.png" alt="oauthAuthorizationPrompt">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/resultJson.png" alt="resultJson">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we start implementing our client application we need to prepare our Atlassian account and development environment. In this section we will do preparation step by step.</p>
</div>
<div class="sect2">
<h3 id="_create_a_jira_cloud_account">Create a Jira Cloud account</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <a href="https://www.atlassian.com/try/cloud/signup?bundle=jira-software" class="bare">https://www.atlassian.com/try/cloud/signup?bundle=jira-software</a> and create an (free trial) account.</p>
</li>
<li>
<p>You can skip every skippable thing.</p>
</li>
<li>
<p>Select Kanban, name your project as <code>Demo</code> and go.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
At the time of this writing, Atlassian is accepting <em>guerrillamail</em> addresses. So you can use an email address like <code>demo-yourname@grr.la</code> and then validate the email address via <a href="https://www.guerrillamail.com" class="bare">https://www.guerrillamail.com</a> .
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_install_ngrok">Install ngrok</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download and install it from <a href="https://ngrok.com" class="bare">https://ngrok.com</a></p>
</li>
<li>
<p>Then start it as follows: <code>./ngrok http 8080</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We will be working with the <em>https</em> version of the URL.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/ngrokOutput.png" alt="ngrokOutput">
</div>
<div class="title">Figure 1. ngrok output should be very similar to this one.</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Don&#8217;t close or restart it during your work. ngrok domain is changed in every restart.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Don&#8217;t try to CTRL+C the URL in the console output as it will kill the process. Just CTRL+click on it and it will be open in default browser.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_create_an_atlassian_application">Create an Atlassian application</h3>
<div class="paragraph">
<p>Go to <a href="https://developer.atlassian.com/apps/" class="bare">https://developer.atlassian.com/apps/</a> and create a new app.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/createYourFirstAppAtlassian.png" alt="createYourFirstAppAtlassian">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/createApp.png" alt="createApp">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/appDetails.png" alt="appDetails">
</div>
</div>
<div class="paragraph">
<p>Ensure you have <code>OAuth 2.0 (3LO)</code> (highlighted in above image).</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t see <code>OAuth 2.0 (3LO)</code> then enable it with <a href="https://developer.atlassian.com/cloud/jira/platform/oauth-2-authorization-code-grants-3lo-for-apps/#enabling-oauth-2-0&#8212;&#8203;3lo-">those steps</a>.</p>
</div>
<div class="sect3">
<h4 id="_add_your_callback_url">Add your callback URL</h4>
<div class="ulist">
<ul>
<li>
<p>Use the ngrok URL</p>
</li>
<li>
<p>It should be HTTPS</p>
</li>
<li>
<p>You don&#8217;t have to use <code>/callback</code>. You can change it if you want.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/addCallbackToWhitelist.png" alt="addCallbackToWhitelist">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_jira_api">Add Jira API</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <code>Add APIs</code> link after saving your callback URL.</p>
</li>
<li>
<p>Add <em>Jira platform REST API</em>.</p>
</li>
<li>
<p>Click <code>configure</code> on <em>Jira platform REST API</em>.</p>
</li>
<li>
<p>Ensure <code>read:jira-user</code> scope is added.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/addJiraApi.png" alt="addJiraApi">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/ensureScopes.png" alt="ensureScopes">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Talk is cheap show me the code</div>
<div class="paragraph">
<p>Now we have prepared our accounts and environment and we are ready to create a Spring Boot application to act as a client to our Jira Cloud account.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_client_application">Creating the client application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before creating the application we should check if our environment is actually working.</p>
</div>
<div class="paragraph">
<p>Otherwise we could easily be lost hours trying to solve a bug which is never in the application but in the account configuration.</p>
</div>
<div class="sect2">
<h3 id="_validating_our_setup">Validating our setup</h3>
<div class="paragraph">
<p><strong>1)</strong> Replace <code>YOUR_CLIENT_ID</code> and <code>YOUR_NGROK_DOMAIN</code> in following URL and call it from your browser.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Remember that <code>YOUR_CLIENT_ID</code> can be found in <em>app details</em> from <a href="https://developer.atlassian.com/apps">Atlassian Applications</a> page.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>https://auth.atlassian.com/authorize?audience=api.atlassian.com&amp;client_id=YOUR_CLIENT_ID&amp;scope=read:jira-user&amp;redirect_uri=https://YOUR_NGROK_DOMAIN/callback&amp;state=KODGEMISI&amp;response_type=code&amp;prompt=consent</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>2)</strong> It should ask you for authorization as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/oauthAuthorizationPrompt.png" alt="oauthAuthorizationPrompt">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Troubleshooting</div>
<div class="paragraph">
<p>If you see below error then (as the error message says) you need to create a Jira Cloud account. See <a href="#_create_a_jira_cloud_account">Create a Jira Cloud account</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/dontHaveJiraSiteError.png" alt="dontHaveJiraSiteError">
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>3)</strong> Accept it and you should see an ngrok error page like below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/failedTunnelError.png" alt="failedTunnelError">
</div>
</div>
<div class="paragraph">
<p>Your browser&#8217;s address bar should be something like:</p>
</div>
<div class="paragraph">
<p><code><a href="https://4769d10f.ngrok.io/callback?code=XXXXXXXXXXXXXXXX&amp;state=KODGEMISI" class="bare">https://4769d10f.ngrok.io/callback?code=XXXXXXXXXXXXXXXX&amp;state=KODGEMISI</a></code></p>
</div>
<div class="paragraph">
<p>Note that the state is the same as we provided (<code>KODGEMISI</code>) and the URL is the redirection URL we entered in the Atlassian app&#8217;s OAuth configuration page.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Remember that <code>4769d10f.ngrok.io</code> points to <code>localhost:8080</code> hence, <code><a href="https://4769d10f.ngrok.io/callback" class="bare">https://4769d10f.ngrok.io/callback</a></code> means <code>localhost:8080/callback</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now it&#8217;s clear that we need to create an application which handles <code>/callback</code> URL path.</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_spring_boot_project">Create a Spring Boot project</h3>
<div class="paragraph">
<p>Go to start.spring.io or your IDE&#8217;s create Spring Boot project wizard and select followings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using latest stable Spring Boot version, Java 11 and Maven</p>
</li>
<li>
<p>Spring Web</p>
</li>
<li>
<p>Thymeleaf</p>
</li>
<li>
<p>OAuth2 Client</p>
</li>
<li>
<p>Lombok</p>
</li>
<li>
<p>Spring Boot DevTools</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_dependencies">Dependencies</h4>
<div class="paragraph">
<p>We will also need to add following dependency manually:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.springframework.security.oauth<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>spring-security-oauth2<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${spring-security-oauth2.version}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that only <em>Spring Web</em>, <em>OAuth2 Client</em> and manually added <em>spring-security-oauth2</em> are essential dependencies. Other dependencies are just for developer&#8217;s convenience.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You need to choose a compatible version of <code>spring-security-oauth2</code> with your Spring Security dependency. Check Spring Security dependency version in <a href="https://mvnrepository.com/artifact/org.springframework.security.oauth/spring-security-oauth2/2.3.6.RELEASE">spring-security-oauth2&#8217;s maven page</a> and ensure it&#8217;s the same with your Spring Security dependency version which is resolved from <code>spring-boot-starter-oauth2-client</code>. If you can&#8217;t find the same version then use the latest version of <code>spring-security-oauth2</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Final pom.xml should be like this</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>
    <span class="tag">&lt;parent&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>2.1.8.RELEASE<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;relativePath</span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;/parent&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.kodgemisi.blog<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>jira-cloud-oAuth2-client<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;name&gt;</span>Jira Cloud OAuth2 Client with Spring Boot<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;description&gt;</span>Jira Cloud OAuth2 Client with Spring Boot<span class="tag">&lt;/description&gt;</span>
    <span class="tag">&lt;properties&gt;</span>
        <span class="tag">&lt;java.version&gt;</span>11<span class="tag">&lt;/java.version&gt;</span>
        <span class="tag">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="tag">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.reporting.outputEncoding&gt;</span>
        <span class="tag">&lt;maven.compiler.source&gt;</span>11<span class="tag">&lt;/maven.compiler.source&gt;</span>
        <span class="tag">&lt;maven.compiler.target&gt;</span>11<span class="tag">&lt;/maven.compiler.target&gt;</span>
        <span class="tag">&lt;spring-security-oauth2.version&gt;</span>2.3.6.RELEASE<span class="tag">&lt;/spring-security-oauth2.version&gt;</span>
    <span class="tag">&lt;/properties&gt;</span>
    <span class="tag">&lt;dependencies&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-oauth2-client<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.springframework.security.oauth<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>spring-security-oauth2<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>${spring-security-oauth2.version}<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.projectlombok<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>lombok<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;optional&gt;</span>true<span class="tag">&lt;/optional&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>spring-boot-devtools<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>com.github.kodgemisi<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>better-error-pages-spring-boot-starter<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>${better-error-pages-spring-boot-starter.version}<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;scope&gt;</span>runtime<span class="tag">&lt;/scope&gt;</span>
            <span class="tag">&lt;optional&gt;</span>true<span class="tag">&lt;/optional&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
    <span class="tag">&lt;build&gt;</span>
        <span class="tag">&lt;plugins&gt;</span>
            <span class="tag">&lt;plugin&gt;</span>
                <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
                <span class="tag">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;/plugin&gt;</span>
        <span class="tag">&lt;/plugins&gt;</span>
    <span class="tag">&lt;/build&gt;</span>
<span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuration">Configuration</h4>
<div class="paragraph">
<p>We will define following values in <code>application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span class="key">security</span>:
  <span class="key">oauth2</span>:
    <span class="key">client</span>:
      <span class="key">clientId</span>: <span class="string"><span class="content">${CLIENT_ID}</span></span>
      <span class="key">clientSecret</span>: <span class="string"><span class="content">${CLIENT_SECRET}</span></span>
      <span class="key">accessTokenUri</span>: <span class="string"><span class="content">https://auth.atlassian.com/oauth/token</span></span>
      <span class="key">userAuthorizationUri</span>: <span class="string"><span class="content">https://auth.atlassian.com/authorize?audience=api.atlassian.com</span></span>
      <span class="key">scope</span>: <span class="string"><span class="content">'read:jira-user'</span></span>
      <span class="key">grantType</span>: <span class="string"><span class="content">'authorization_code'</span></span>
      <span class="key">preEstablishedRedirectUri</span>: <span class="string"><span class="content">${CALLBACK_URL}</span></span>
      <span class="key">useCurrentUri</span>: <span class="string"><span class="content">false</span></span>

<span class="key">app</span>:
  <span class="key">cloudId</span>: <span class="string"><span class="content">${CLOUD_ID}</span></span>
  <span class="key">jiraUrl</span>: <span class="string"><span class="content">https://api.atlassian.com/ex/jira/${app.cloudId}/rest/api/3</span></span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>CLIENT_ID: find it from app details page on <a href="https://developer.atlassian.com/apps" class="bare">https://developer.atlassian.com/apps</a></p>
</li>
<li>
<p>CLIENT_SECRET: secret value on the same page</p>
</li>
<li>
<p>CALLBACK_URL is like <a href="https://4769d10f.ngrok.io/callback" class="bare">https://4769d10f.ngrok.io/callback</a></p>
</li>
<li>
<p>CLOUD_ID is the id of your Jira Cloud instance. See below section to learn how to obtain it.</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
You should define those values as environment variables or pass them as JVM arguments so that client id and secret won&#8217;t end up in your Git repository.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Obtaining your <code>CLOUD_ID</code></div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <a href="https://admin.atlassian.com" class="bare">https://admin.atlassian.com</a></p>
</li>
<li>
<p>Click on your site</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/atlassianAdmin.png" alt="atlassianAdmin">
</div>
</div>
<div class="paragraph">
<p>Look at the address bar: <code><a href="https://admin.atlassian.com/s/1324a887-45db-1bf4-1e99-ef0ff456d421/users" class="bare">https://admin.atlassian.com/s/1324a887-45db-1bf4-1e99-ef0ff456d421/users</a></code>.</p>
</div>
<div class="paragraph">
<p><code>1324a887-45db-1bf4-1e99-ef0ff456d421</code> part is your cloud id.</p>
</div>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/ideaEnvVars.png" alt="ideaEnvVars">
</div>
<div class="title">Figure 2. You can define environment variables in your IDE. This is an example screenshot for IntelliJ IDEA.</div>
</div>
<div class="paragraph">
<p>In configuration we define our beans:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Bean</span>
<span class="annotation">@ConfigurationProperties</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">security.oauth2.client</span><span class="delimiter">&quot;</span></span>)
OAuth2ProtectedResourceDetails oauth2RemoteResource() {
    <span class="keyword">return</span> <span class="keyword">new</span> AuthorizationCodeResourceDetails();
}

<span class="annotation">@Bean</span>
OAuth2RestTemplate oauth2RestTemplate(OAuth2ClientContext oauth2ClientContext,
                                      <span class="annotation">@Value</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">${app.jiraUrl}</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> baseUrl) {

    <span class="directive">final</span> OAuth2RestTemplate restTemplate = <span class="keyword">new</span> OAuth2RestTemplate(oauth2RemoteResource(), oauth2ClientContext);
    restTemplate.setUriTemplateHandler(<span class="keyword">new</span> DefaultUriBuilderFactory(baseUrl));
    <span class="keyword">return</span> restTemplate;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>OAuth2ProtectedResourceDetails</code> instance is formed using <code>security.oauth2.client</code> values from <code>application.yml</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_how_will_it_work">How will it work?</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We have configured an <code>OAuth2RestTemplate</code> with our <code>OAuth2ProtectedResourceDetails</code>.</p>
</li>
<li>
<p>We will use this rest template when calling Jira Cloud&#8217;s REST APIs.</p>
</li>
<li>
<p>This rest template automatically checks if there is an access token present (cached).</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If access token <strong>not present</strong> then rest template checks if there are <code>code</code> and <code>state</code> request parameters in request.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If <code>code</code> and <code>state</code> is <strong>found</strong> then it uses them to get an access token from <code>accessTokenUri</code></p>
</li>
<li>
<p>If <code>code</code> and <code>state</code> is <strong>NOT found</strong> then it redirects us to Atlassian&#8217;s authorization page (<code>userAuthorizationUri</code>).</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Recall from <a href="#_validating_our_setup">Validating our setup</a>, Atlassian&#8217;s authorization page redirects user to configured callback url with <code>code</code> and <code>state</code> query parameters.</p>
</li>
<li>
<p>Now we have <code>code</code> and <code>state</code> values at hand and manually make the <code>OAuth2RestTemplate</code> call <code>getAccessToken()</code> now. Once access token is retrieved it will be cached internally by <code>OAuth2RestTemplate</code>.</p>
</li>
<li>
<p>At this point we have an access token however not yet make the actual request to Jira Cloud API. Hence, we need to redirect the user to the original URL. After this redirection the flow will hit <em>if access token is present</em> state.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>If access token <strong>is present</strong> then rest template uses the cached access code and puts it in request header before calling Jira Cloud&#8217;s REST APIs.</p>
</li>
</ol>
</div>
</li>
<li>
<p>We happily get our response <strong>🥳</strong></p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Further descriptions on implementation details can be found in the sample code.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_handling_the_callback">Handling the <code>/callback</code></h4>
<div class="paragraph">
<p>The <code>/callback</code> handler has two main responsibility:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Getting the access token from <code>accessTokenUri</code> using <code>code</code> and <code>state</code> values.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>This will be done via <code>restTemplate.getAccessToken()</code> method call. <code>getAccessToken</code> will find <code>code</code> and <code>state</code> values internally so we don&#8217;t have to pass them.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Redirecting to the original URL after caching the access token.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>We keep the original URL in <code>savedRequest</code> instance. We will see how we create and keep this <code>savedRequest</code> later.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Controller</span>
<span class="annotation">@RequiredArgsConstructor</span>
<span class="type">class</span> <span class="class">CallbackControllerController</span> {

        <span class="directive">private</span> <span class="directive">final</span> OAuth2RestTemplate restTemplate;

        <span class="annotation">@GetMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/callback</span><span class="delimiter">&quot;</span></span>)
        <span class="predefined-type">String</span> callback(HttpSession httpSession) {

                <span class="directive">final</span> SavedRequest savedRequest = (SavedRequest) httpSession.getAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">SPRING_SECURITY_SAVED_REQUEST</span><span class="delimiter">&quot;</span></span>);
                httpSession.removeAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">SPRING_SECURITY_SAVED_REQUEST</span><span class="delimiter">&quot;</span></span>);

                restTemplate.getAccessToken();

                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">redirect:</span><span class="delimiter">&quot;</span></span> + savedRequest.getRedirectUrl();
        }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_keeping_the_original_url">Keeping the original URL</h4>
<div class="paragraph">
<p>As we mentioned in the 2nd responsibility of callback handler, we need to keep the original URL only when we are being redirected to Atlassian&#8217;s authorization page.</p>
</div>
<div class="paragraph">
<p>The best place to implement this is <code>RedirectStrategy</code> of <code>OAuth2ClientContextFilter</code>.</p>
</div>
<div class="listingblock">
<div class="title">Providing a <code>RedirectStrategy</code> implementation which will save the original URL in session just before redirecting</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">OAuth2RedirectStrategy</span> <span class="directive">extends</span> DefaultRedirectStrategy {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> sendRedirect(HttpServletRequest request, HttpServletResponse response, <span class="predefined-type">String</span> url) <span class="directive">throws</span> <span class="exception">IOException</span> {

        <span class="directive">final</span> <span class="predefined-type">String</span> currentUri = (<span class="predefined-type">String</span>) request.getAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">currentUri</span><span class="delimiter">&quot;</span></span>);
        <span class="directive">final</span> HttpSession session = request.getSession(<span class="predefined-constant">false</span>);

        <span class="keyword">if</span> (session != <span class="predefined-constant">null</span>) {
            session.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">SPRING_SECURITY_SAVED_REQUEST</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> SimpleSavedRequest(currentUri));
        }

        <span class="local-variable">super</span>.sendRedirect(request, response, url);
    }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Configuring <code>OAuth2ClientContextFilter</code> to use our <code>RedirectStrategy</code> implementation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Bean</span>
RedirectStrategy oAuth2RedirectStrategy() {
    <span class="keyword">return</span> <span class="keyword">new</span> OAuth2RedirectStrategy();
}

<span class="annotation">@Bean</span>
OAuth2ClientContextFilter oAuth2ClientContextFilter(OAuth2ClientContextFilter oAuth2ClientContextFilter) {
    oAuth2ClientContextFilter.setRedirectStrategy(oAuth2RedirectStrategy());
    <span class="keyword">return</span> oAuth2ClientContextFilter;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that, whenever a callback is made to our <code>/callback</code> url, we will get the access token and then redirect the user to original request url again. This time the user gets the response because we have an access token now.</p>
</div>
<div class="paragraph">
<p>Subsequent requests to Jira Cloud&#8217;s REST API won&#8217;t be redirected because we will be using the cached access token.</p>
</div>
</div>
<div class="sect3">
<h4 id="_putting_all_together">Putting all together</h4>
<div class="paragraph">
<p>So we need some code to actually consumes the Jira Cloud&#8217;s REST API.</p>
</div>
<div class="listingblock">
<div class="title">Example endpoint for us to consume the JIRA API</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Controller</span>
<span class="annotation">@RequiredArgsConstructor</span>
<span class="annotation">@RequestMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/myself</span><span class="delimiter">&quot;</span></span>)
<span class="type">class</span> <span class="class">MyselfController</span> {

    <span class="directive">private</span> <span class="directive">final</span> OAuth2RestTemplate restTemplate;

    <span class="annotation">@GetMapping</span>
    ResponseEntity&lt;<span class="predefined-type">Map</span>&lt;?, ?&gt;&gt; myself(WebRequest request) {

        <span class="directive">final</span> <span class="predefined-type">Map</span>&lt;?, ?&gt; result = restTemplate.getForObject(<span class="string"><span class="delimiter">&quot;</span><span class="content">/myself</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">Map</span>.class);

        <span class="keyword">return</span> ResponseEntity.ok(result);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we don&#8217;t have to use the <code>restTemplate</code> in a controller. It&#8217;s just convenient in a demo application this way. But in a real application
you can use <code>restTemplate</code> in service layer, in a batch job, scheduled job etc.</p>
</div>
<div class="paragraph">
<p>Lastly, to use our client we need to provide a way for the user to be authenticated because Spring Security&#8217;s OAuth2 client implementation requires
the user be fully authenticated before making access token requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@EnableWebSecurity</span>
<span class="type">class</span> <span class="class">WebSecurityConfig</span> <span class="directive">extends</span> WebSecurityConfigurerAdapter {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> configure(HttpSecurity http) <span class="directive">throws</span> <span class="exception">Exception</span> {
        http
            .authorizeRequests().anyRequest().fullyAuthenticated()
            .and()
            .formLogin().and().logout();
    }

    <span class="annotation">@Autowired</span>
    <span class="directive">public</span> <span class="type">void</span> configureGlobal(AuthenticationManagerBuilder auth) <span class="directive">throws</span> <span class="exception">Exception</span> {
        auth.inMemoryAuthentication().withUser(<span class="string"><span class="delimiter">&quot;</span><span class="content">kodgemisi</span><span class="delimiter">&quot;</span></span>).password(<span class="string"><span class="delimiter">&quot;</span><span class="content">{noop}kodgemisi</span><span class="delimiter">&quot;</span></span>).roles(<span class="string"><span class="delimiter">&quot;</span><span class="content">USER</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_application">Using the application</h4>
<div class="ulist">
<ul>
<li>
<p>Go to link <code><a href="https://NGROK_HOST_NAME" class="bare">https://NGROK_HOST_NAME</a></code>.</p>
</li>
<li>
<p>Login</p>
<div class="ulist">
<ul>
<li>
<p>username: kodgemisi</p>
</li>
<li>
<p>password: kodgemisi</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click the link <em>Show "myself" resource from Atlassian Jira Cloud</em></p>
<div class="ulist">
<ul>
<li>
<p>You will be redirected to Atlassian authorization page, accept the authorization</p>
</li>
<li>
<p>You will be redirected to your callback, hence your application</p>
</li>
</ul>
</div>
</li>
<li>
<p>Your application makes a request to Jira API behind the scenes and returns you the JSON response.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/resultJson.png" alt="resultJson">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting">Troubleshooting</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_callback_url_is_not_whitelisted">Callback URL is not whitelisted</h3>
<div class="imageblock">
<div class="content">
<img src="./images/callbackNotRegisteredError.png" alt="callbackNotRegisteredError">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>Something went wrong while executing your request.
Error: Redirect failed because the supplied callback URL is not whitelisted for this application.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Possible cause:</div>
<p>ngrok URL may be changed. It changes every time you start ngrok. You should be pro ngrok user to have a static URL.</p>
</div>
<div class="paragraph">
<div class="title">Solution</div>
<p>Reset your callback URL from <code>App Details</code> page on <code><a href="https://developer.atlassian.com/apps/&lt;yourAppId&gt;/details" class="bare">https://developer.atlassian.com/apps/&lt;yourAppId&gt;/details</a></code></p>
</div>
</div>
<div class="sect2">
<h3 id="_failed_to_complete_tunnel_connection">Failed to complete tunnel connection</h3>
<div class="imageblock">
<div class="content">
<img src="./images/failedTunnelError.png" alt="failedTunnelError">
</div>
</div>
<div class="paragraph">
<div class="title">Possible cause:</div>
<p>Your application isn&#8217;t running or crashed.</p>
</div>
<div class="paragraph">
<div class="title">Solution</div>
<p>Restart the application :)</p>
</div>
<div class="paragraph">
<div class="title">Possible cause:</div>
<p>ngrok URL is wrong.</p>
</div>
<div class="paragraph">
<div class="title">Solution</div>
<p>Update the URL in Atlassian app details page and in your application&#8217;s <code>application.yml</code> file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://developer.atlassian.com/cloud/jira/platform/oauth-2-authorization-code-grants-3lo-for-apps/">OAuth 2.0 (3LO) for Atlassian cloud apps</a></p>
</li>
<li>
<p><a href="https://aaronparecki.com/oauth-2-simplified/">OAuth 2 Simplified Guide</a></p>
</li>
<li>
<p><a href="https://projects.spring.io/spring-security-oauth/docs/oauth2.html#configuring-client-details">Configuring Client Details (Spring Security OAuth2 Developers Guide)</a></p>
</li>
<li>
<p><a href="https://spring.io/guides/tutorials/spring-boot-oauth2/">Spring Boot and OAuth2</a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_more_readings">More readings</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://stackoverflow.com/a/13384100/878361">Why is there 3-legged OAuth2 when 2-legged works so well?</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/13387698/why-is-there-an-authorization-code-flow-in-oauth2-when-implicit-flow-works-s/13389335#13389335">Why is there an “Authorization Code” flow in OAuth2 when “Implicit” flow works so well?</a></p>
</li>
<li>
<p><a href="https://superuser.com/a/59094/104973">Host name vs domain name</a></p>
</li>
<li>
<p><a href="https://developer.atlassian.com/cloud/jira/platform/integrating-with-jira-cloud/">Integrating with Jira Cloud</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<section id="comments">
    <h2 id="_view">Comments</h2>

    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = "https://kodgemisi-blog.github.io/jira-cloud-oauth2-client-with-spring-boot/";
            this.page.identifier = "jira-cloud-oAuth2-client";
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://kod-gemisi-github-blog.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

<div id="footer">
    <a href="https://kodgemisi.com/" target="_blank" style="float: right;">
        <img src="images/kodgemisi-logo.png" style="filter: brightness(0) invert(1);width: 200px;">
    </a>
    <div id="footer-text">
        <a id="scmUrl" href="https://github.com/kodgemisi-blog/jira-cloud-oauth2-client-with-spring-boot">Source code of the app in this post</a> <br>
        <a href="https://blog.kodgemisi.com/">Kod Gemisi Blog</a>
    </div>
</div>

<script>
    {
        const clonedEl = document.getElementById('scmUrl').cloneNode( true );
        clonedEl.id = 'scmUrlLeft';
        clonedEl.text = 'Github link of the app in this post';
        document.getElementById('toc').appendChild(clonedEl);
    }
</script>
</body>
</html>